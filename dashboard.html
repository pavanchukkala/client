<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <title>Owner Dashboard | OM Castings</title>
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #1f1c2c, #928dab);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      min-height: 100vh;
      padding: 20px;
    }

    .dashboard-container {
      width: 100%;
      max-width: 1200px;
      margin: auto;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }

    h1 {
      font-size: 2.5rem;
      text-align: center;
      margin-bottom: 20px;
    }

    nav {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
    }

    nav a {
      color: #fff;
      text-decoration: none;
      font-size: 1.2rem;
      padding: 10px 20px;
      border-radius: 25px;
      background: linear-gradient(90deg, #ff512f, #dd2476);
      transition: background 0.3s ease, transform 0.3s ease;
    }

    nav a:hover {
      background: linear-gradient(90deg, #dd2476, #ff512f);
      transform: scale(1.1);
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    .contact-item,
    .media-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      margin-bottom: 10px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 10px;
      color: #fff;
    }

    button.action {
      padding: 8px 15px;
      font-size: 0.9rem;
      color: #fff;
      background: #e63946;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button.action:hover {
      background: #c5303b;
    }

    button#logout {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 1rem;
      background: linear-gradient(90deg, #ff512f, #dd2476);
      border: none;
      border-radius: 25px;
      color: #fff;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    button#logout:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 15px rgba(255, 81, 47, 0.6);
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <h1>Owner Dashboard</h1>
    <nav>
      <a href="#" data-section="contact-section">Contact Management</a>
      <a href="#" data-section="media-section">Media Management</a>
    </nav>

    <!-- Contact Section -->
    <div id="contact-section" class="section active">
      <h2>Contact Data</h2>
      <div id="contactList">
        <!-- Dynamic contact entries from Firebase -->
      </div>
    </div>

    <!-- Media Section -->
    <div id="media-section" class="section">
      <h2>Media Management</h2>
      <div class="upload-section">
        <input type="file" id="fileInput" />
        <button id="uploadMedia">Upload Media</button>
      </div>
      <div id="mediaList">
        <!-- Dynamic media items from Firebase -->
      </div>
    </div>

    <button id="logout">Logout</button>
  </div>

  <script type="module">
    // Import Firebase and initialize your project
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import {
      getFirestore,
      collection,
      getDocs,
      deleteDoc,
      doc,
    } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
    import {
      getStorage,
      ref,
      uploadBytes,
      getDownloadURL,
      listAll,
    } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js";

    const firebaseConfig = {
      // Your Firebase configuration
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    // Manage Navigation
    const navLinks = document.querySelectorAll("nav a");
    const sections = document.querySelectorAll(".section");
    navLinks.forEach((link) =>
      link.addEventListener("click", () => {
        sections.forEach((section) => section.classList.remove("active"));
        document
          .getElementById(link.dataset.section)
          .classList.add("active");
      })
    );

    // Contact Management
    const contactList = document.getElementById("contactList");
    const renderContacts = async () => {
      const querySnapshot = await getDocs(collection(db, "contacts"));
      contactList.innerHTML = "";
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        const contactItem = document.createElement("div");
        contactItem.className = "contact-item";
        contactItem.innerHTML = `
          <p>${data.name} - ${data.email}</p>
          <button class="action" onclick="deleteContact('${doc.id}')">Delete</button>
        `;
        contactList.appendChild(contactItem);
      });
    };

    const deleteContact = async (id) => {
      await deleteDoc(doc(db, "contacts", id));
      renderContacts();
    };

    // Media Management
    const fileInput = document.getElementById("fileInput");
    const mediaList = document.getElementById("mediaList");

    const uploadMedia = async () => {
      const file = fileInput.files[0];
      if (!file) return alert("Select a file first!");
      const storageRef = ref(storage, `media/${file.name}`);
      await uploadBytes(storageRef, file);
      alert("File uploaded successfully!");
      renderMedia();
    };

    document.getElementById("uploadMedia").addEventListener("click", uploadMedia);

    const renderMedia = async () => {
      const mediaRef = ref(storage, "media/");
      const files = await listAll(mediaRef);
      mediaList.innerHTML = "";
      files.items.forEach(async (itemRef) => {
        const url = await getDownloadURL(itemRef);
        const mediaItem = document.createElement("div");
        mediaItem.className = "media-item";
        mediaItem.innerHTML = `
          <p>${itemRef.name}</p>
          <a href="${url}" target="_blank" class="action">View</a>
        `;
        mediaList.appendChild(mediaItem);
      });
    };

    // Logout Button
    document.getElementById("logout").addEventListener("click", () => {
      alert("Logged out successfully!");
      location.reload();
    });

    // Initial Rendering
    renderContacts();
    renderMedia();
  </script>
</body>
</html>
